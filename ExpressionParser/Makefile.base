#
# (C) Copyright University of Connecticut Health Center 2001.
# All rights reserved.
#

CC = g++
BASE_CPPFLAGS0 = -D$(PLATFORM) -O2 -fexceptions
TARGET= libExpParser.a
LIBTOOL = ar -cru
DEL = rm

ifeq ($(PLATFORM), MACOSX)
BASE_CPPFLAGS = $(BASE_CPPFLAGS0) -arch x86_64 -arch ppc -arch i386 -isysroot /Developer/SDKs/MacOSX10.5.sdk -mmacosx-version-min=10.5
else 
BASE_CPPFLAGS = $(BASE_CPPFLAGS0) 
endif

ifdef NATIVELIB
CPPFLAGS = -fPIC $(BASE_CPPFLAGS)
else
CPPFLAGS = $(BASE_CPPFLAGS)
endif

%.o : %.cpp		
	$(CC) -c $(CPPFLAGS) $<

default all: $(TARGET)

CPPOBJECTS = ASTAddNode.o \
	ASTAndNode.o \
	ASTExpression.o \
	ASTFloatNode.o \
	ASTFuncNode.o \
	ASTIdNode.o \
	ASTInvertTermNode.o \
	ASTMinusTermNode.o \
	ASTMultNode.o \
	ASTNotNode.o \
	ASTOrNode.o \
	ASTPowerNode.o \
	ASTRelationalNode.o \
	DivideByZeroException.o \
	Exception.o \
	Expression.o \
	ExpressionBindingException.o \
	ExpressionException.o \
	ExpressionParser.o \
	ExpressionParserTokenManager.o \
	FunctionDomainException.o \
	FunctionRangeException.o \
	IOException.o \
	JJTExpressionParserState.o \
	MathUtil.o \
	ParseException.o \
	ParserException.o \
	RuntimeException.o \
	SimpleCharStream.o \
	SimpleNode.o \
	SimpleSymbolTable.o \
	SimpleSymbolTableEntry.o \
	StackMachine.o \
	Token.o  \
	ValueProxy.o

$(TARGET):	$(CPPOBJECTS)	
	$(LIBTOOL) $@ $(CPPOBJECTS) 
	ranlib $@
	
clean:	
	$(DEL) *.o $(TARGET)
	
depend:
	makedepend -Y -f Makefile.base -- $(CPPFLAGS) -- *.c *.cpp
