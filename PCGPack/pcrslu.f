      SUBROUTINEPCRSLU(IBLKN,IBLKS,IBTRM,IRTBM,IBTRMC,NBLCKB,
     *ND2I,C,IC,IJA,A,ID2I,IPVT,D2I)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      INTEGERIBLKN,IBLKS(*),IBTRM(*),IRTBM(*),IBTRMC(*),NBLCKB,
     *ND2I,C(*),IC(*),IJA(*),ID2I(*),IPVT(*)
      DOUBLEPRECISIONA(*),D2I(*)
      INTEGERIERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,LUDONE,IBLK,
     *MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,IFRMAT
      COMMON/PCCOM1/IERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,
     *LUDONE,IBLK,MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,
     *IFRMAT
      SAVE/PCCOM1/
      INTEGERI,J,K,L,BCOL,IROW,ICOL,ROW,NNM1,KP1,RAWBCL,
     *PROW,PTRCNT,BD2I,ROWOFF,RF2,NN
      INTEGERIDAMAX,ONE
      DOUBLEPRECISIONT,DK
      ONE=1
      CALLPC0V(ND2I,D2I)
      ID2I(1)=1
      BD2I=0
      PTRCNT=0
      DO1I=NBLCKB+1,IBLKN
      ROW=C(I)
      ROWOFF=BD2I
      NN=IBLKS(ROW)
      NNM1=NN-1
      ID2I(I-NBLCKB)=BD2I+1
      DO3K=IBTRM(ROW),IBTRM(ROW+1)-1
      IROW=1-IBTRM(ROW)+K
      D2I(ROWOFF+IROW)=A(K)
      DO5L=IJA(K),IJA(K+1)-1
      RAWBCL=IRTBM(IJA(L))
      BCOL=IC(RAWBCL)
      ICOL=IJA(L)-IBTRM(RAWBCL)+1
      IF(BCOL.EQ.I)THEN
      D2I(ROWOFF+ICOL)=A(L)
      ENDIF
5     CONTINUE
      ROWOFF=ROWOFF+NN
3     CONTINUE
      ROWOFF=BD2I
      DO7K=1,NNM1
      PTRCNT=PTRCNT+1
      KP1=K+1
      L=IDAMAX(NN-K+1,D2I(ROWOFF+K),NN)
      T=D2I(ROWOFF+K+NN*(L-1))
      IF(T.EQ.0.0D0)THEN
      IERR2=IBTRM(ROW)+K-1
      IERR=11
      RETURN
      ENDIF
      IPVT(PTRCNT)=L-1+K
      IF(L.NE.1)THEN
      CALLDSWAP(NN,D2I(ROWOFF+1),ONE,D2I(ROWOFF+1+NN*(L-1)),
     *ONE)
      ENDIF
      T=1.0D0/T
      D2I(ROWOFF+K)=T
      CALLDSCAL(NN-K,T,D2I(ROWOFF+K+1),ONE)
      RF2=ROWOFF+K
      PROW=RF2+1
      DO9J=KP1,NN
      RF2=RF2+NN
      CALLDAXPY(NN-K,-D2I(RF2),D2I(PROW),ONE,D2I(RF2+1),ONE)
9     CONTINUE
      ROWOFF=ROWOFF+NN
7     CONTINUE
      PTRCNT=PTRCNT+1
      IPVT(PTRCNT)=NN
      T=D2I(ROWOFF+NN)
      IF(T.EQ.0.0D0)THEN
      IERR2=IBTRM(ROW)+NNM1
      IERR=11
      RETURN
      ENDIF
      DK=1.0D0/T
      D2I(ROWOFF+NN)=DK
      BD2I=ROWOFF+NN
1     CONTINUE
      RETURN
      END
