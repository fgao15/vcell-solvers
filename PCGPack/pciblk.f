      SUBROUTINEPCIBLK(N,IBLK,IJA,IBLKN,MAXBLK,IBLKS)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      INTEGERN,IBLK,IJA(*),IBLKN,MAXBLK,IBLKS(*)
      INTEGERIPRE1,IPRE2,RATIO
      COMMON/PCCOM3/IPRE1,IPRE2,RATIO
      SAVE/PCCOM3/
      INTEGERISRT,IJASGN,ISX0,IFORM
      COMMON/PCVERI/ISRT,IJASGN,ISX0,IFORM
      SAVE/PCVERI/
      INTEGERI,J
      IF(IBLK.GT.0)THEN
      IBLKN=(N+IBLK-1)/IBLK
      DO1I=1,IBLKN
      IBLKS(I)=IBLK
1     CONTINUE
      IF(MOD(N,IBLK).NE.0)THEN
      IBLKS(IBLKN)=MOD(N,IBLK)
      ENDIF
      MAXBLK=IBLK
      IF(IJASGN.EQ.0)THEN
      CALLPCIABS(N,IJA)
      ENDIF
      ELSE
      IBLKN=0
      J=1
      MAXBLK=1
      DO3I=1,N
      IF(IJA(I+1).GT.0)THEN
      MAXBLK=MAX(J,MAXBLK)
      IBLKN=IBLKN+1
      IBLKS(IBLKN)=J
      J=1
      ELSE
      IJA(I+1)=-IJA(I+1)
      J=J+1
      ENDIF
3     CONTINUE
      ENDIF
      RETURN
      END
