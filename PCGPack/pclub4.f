      SUBROUTINEPCLUB4(N,NZLUMX,I1,IBLKSK,NLI,NI,IPVT,JCOL,ROW
     *,NZL,NZU,IJL,IJU,LD,U)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      INTEGERN,NZLUMX,I1,IBLKSK,NLI,NI,NZL,NZU,IPVT(*),
     *JCOL(*),IJL(*),IJU(*)
      DOUBLEPRECISIONROW(*),LD(*),U(*)
      INTEGERIERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,LUDONE,IBLK,
     *MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,IFRMAT
      COMMON/PCCOM1/IERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,
     *LUDONE,IBLK,MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,
     *IFRMAT
      SAVE/PCCOM1/
      INTEGERIPRE1,IPRE2,RATIO
      COMMON/PCCOM3/IPRE1,IPRE2,RATIO
      SAVE/PCCOM3/
      INTEGERII,JJ,I,J,IPVTI,RBASE,JCOLJ
      II=I1
      JJ=NLI
      DO1I=1,IBLKSK
      IPVTI=IPVT(I)
      RBASE=(IPVTI-1)*N
      DO3J=1,JJ
      JCOLJ=JCOL(J)
      IF(ROW(RBASE+JCOLJ).NE.0.0D0)THEN
      NZL=NZL+1
      IF(NZL.GT.NZLUMX)THEN
      NZL=NZL*N/(I1-1+I)
      NZU=NZU*N/(I1-1+I)
      IERR=3
      RETURN
      ENDIF
      LD(NZL)=ROW(RBASE+JCOLJ)*LD(JCOLJ)
      IJL(NZL)=JCOLJ
      ENDIF
3     CONTINUE
      LD(II)=ROW(RBASE+II)
      DO5J=JJ+2,NI
      JCOLJ=JCOL(J)
      IF(ROW(RBASE+JCOLJ).NE.0.0D0)THEN
      NZU=NZU+1
      IF(NZU.GT.NZLUMX)THEN
      NZL=NZL*N/(I1-1+I)
      NZU=NZU*N/(I1-1+I)
      IERR=3
      RETURN
      ENDIF
      U(NZU)=ROW(RBASE+JCOLJ)
      IJU(NZU)=JCOLJ
      ENDIF
5     CONTINUE
      JJ=JJ+1
      II=II+1
      IJL(II)=NZL+1
      IJU(II)=NZU+1
1     CONTINUE
      RETURN
      END
