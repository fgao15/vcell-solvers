      SUBROUTINEPCRSPS(N,NZRSMX,NBLACK,C,IC,IJA,NZRS,IJRS,
     *MARK,FIC)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      INTEGERN,NZRSMX,NBLACK,C(*),IC(*),IJA(*),NZRS,IJRS(*),
     *MARK(*),FIC(*)
      INTEGERIERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,LUDONE,IBLK,
     *MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,IFRMAT
      COMMON/PCCOM1/IERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,
     *LUDONE,IBLK,MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,
     *IFRMAT
      SAVE/PCCOM1/
      INTEGERI,J,K,L,IFIC,BCOL,PCOL,IJAL
      CALLPC0VI(N,MARK)
      IJRS(1)=NBLACK+2
      NZRS=NBLACK+1
      DO1I=1,NBLACK
      MARK(I)=I
      IFIC=0
      K=C(I)
      DO3L=IJA(K),IJA(K+1)-1
      IJAL=IJA(L)
      BCOL=IC(IJAL)
      IF(BCOL.LE.NBLACK)THEN
      IF(MARK(BCOL).NE.I)THEN
      MARK(BCOL)=I
      IFIC=IFIC+1
      FIC(IFIC)=BCOL
      ENDIF
      ELSE
      DO5J=IJA(IJAL),IJA(IJAL+1)-1
      PCOL=IC(IJA(J))
      IF(MARK(PCOL).NE.I)THEN
      MARK(PCOL)=I
      IFIC=IFIC+1
      FIC(IFIC)=PCOL
      ENDIF
5     CONTINUE
      ENDIF
3     CONTINUE
      IF(IFIC+NZRS.GT.NZRSMX)THEN
      NZRSMX=IFIC*(N-I+1)/I
      IERR=10
      RETURN
      ENDIF
      DO7J=1,IFIC
      NZRS=NZRS+1
      IJRS(NZRS)=FIC(J)
7     CONTINUE
      IJRS(I+1)=NZRS+1
1     CONTINUE
      RETURN
      END
