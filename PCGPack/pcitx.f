      SUBROUTINEPCITX(PCIT,N,IJA,A,RHS,X,RN,RP,P,AR,ATP,
     *APAP,BIJ,ISP,RSP,PRECON,PCSTOP,PCMV)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      INTEGERPCIT,N,IJA(*),ISP(*)
      DOUBLEPRECISIONA(*),RHS(*),X(*),RN(*),RP(*),P(N,*),
     *AR(*),ATP(N,*),APAP(*),BIJ(*),RSP(*)
      EXTERNALPRECON,PCSTOP,PCMV
      INTEGERIERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,LUDONE,IBLK,
     *MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,IFRMAT
      COMMON/PCCOM1/IERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,
     *LUDONE,IBLK,MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,
     *IFRMAT
      SAVE/PCCOM1/
      INTEGERIPRE1,IPRE2,RATIO
      COMMON/PCCOM3/IPRE1,IPRE2,RATIO
      SAVE/PCCOM3/
      INTEGERISRT,IJASGN,ISX0,IFORM
      COMMON/PCVERI/ISRT,IJASGN,ISX0,IFORM
      SAVE/PCVERI/
      INTEGERONE,J
      INTEGERNP,NV,LTEST
      DOUBLEPRECISIONAI,T
      DOUBLEPRECISIONDDOT
      ONE=1
      IF(ISX0.NE.1)THEN
      CALLPCMV(N,IJA,A,X,RN)
      CALLPCVSUB(N,RN,RHS)
      ELSE
      CALLDCOPY(N,RHS,ONE,RN,ONE)
      ENDIF
      IF(IPRE2.NE.-4)THEN
      CALLPRECON(IPRE2,N,IJA,A,RN,ISP,RSP)
      ENDIF
      CALLPCSTOP(ONE,N,IJA,A,RHS,X,RN,ISP,RSP,PRECON)
      IF(IERR.GE.0)THEN
      RETURN
      ENDIF
      IF(IPRE1.NE.-4)THEN
      CALLDCOPY(N,RN,ONE,RP,ONE)
      CALLPCOP(N,IJA,A,RP,AR,ISP,RSP,PRECON,PCMV)
      ELSE
      CALLPCOP(N,IJA,A,RN,AR,ISP,RSP,PRECON,PCMV)
      ENDIF
      CALLDCOPY(N,RP,ONE,P,ONE)
      CALLDCOPY(N,AR,ONE,ATP,ONE)
      NV=0
      NP=1
      LTEST=ITEST
      DO1ITS=1,ITMAX-1
      LTEST=LTEST-1
      T=DDOT(N,ATP(1,NP),ONE,ATP(1,NP),ONE)
      IF(T.EQ.0.0D0)THEN
      IERR=12
      RETURN
      ENDIF
      APAP(NP)=T
      AI=DDOT(N,RN,ONE,ATP(1,NP),ONE)/APAP(NP)
      CALLDAXPY(N,AI,P(1,NP),ONE,X,ONE)
      CALLDAXPY(N,-AI,ATP(1,NP),ONE,RN,ONE)
      IF(LTEST.EQ.0)THEN
      LTEST=ITEST
      CALLPCSTOP(ONE,N,IJA,A,RHS,X,RN,ISP,RSP,PRECON)
      IF(IERR.GE.0)THEN
      RETURN
      ENDIF
      ENDIF
      IF(IPRE1.NE.-4)THEN
      CALLDCOPY(N,RN,ONE,RP,ONE)
      CALLPCOP(N,IJA,A,RP,AR,ISP,RSP,PRECON,PCMV)
      ELSE
      CALLPCOP(N,IJA,A,RN,AR,ISP,RSP,PRECON,PCMV)
      ENDIF
      NP=NP+1
      IF(NP.GT.KMAX)THEN
      NP=1
      ENDIF
      IF(PCIT.EQ.1)THEN
      IF(ITS.LE.KMAX)THEN
      NV=ITS
      ENDIF
      ELSE
      NV=NV+1
      IF(NV.GT.KMAX)THEN
      NV=0
      NP=1
      ENDIF
      ENDIF
      IF(NV.NE.0)THEN
      CALLPCVTM(N,AR,NV,ATP,BIJ)
      DO3J=1,NV
      BIJ(J)=-BIJ(J)/APAP(J)
3     CONTINUE
      CALLPCDMVA(N,NV,ATP,BIJ,AR)
      CALLDCOPY(N,AR,ONE,ATP(1,NP),ONE)
      CALLPCDMV(N,NV,P,BIJ,AR)
      CALLPCVADD(N,P(1,NP),AR,RP)
      ELSE
      CALLDCOPY(N,RP,ONE,P,ONE)
      CALLDCOPY(N,AR,ONE,ATP,ONE)
      ENDIF
1     CONTINUE
      T=DDOT(N,ATP(1,NP),ONE,ATP(1,NP),ONE)
      IF(T.EQ.0.0D0)THEN
      IERR=12
      RETURN
      ENDIF
      APAP(NP)=T
      AI=DDOT(N,RN,ONE,ATP(1,NP),ONE)/APAP(NP)
      CALLDAXPY(N,AI,P(1,NP),ONE,X,ONE)
      CALLDAXPY(N,-AI,ATP(1,NP),ONE,RN,ONE)
      ITS=ITMAX
      CALLPCSTOP(ONE,N,IJA,A,RHS,X,RN,ISP,RSP,PRECON)
      RETURN
      END
