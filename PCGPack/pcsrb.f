      SUBROUTINEPCSRB(N,IJA,A,RHS,X,ISP,RSP,METHOD,PRECON,
     *PCSTOP,PCMV)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      INTEGERN,IJA(*),ISP(*)
      DOUBLEPRECISIONA(*),RHS(*),X(*),RSP(*)
      EXTERNALMETHOD,PRECON,PCSTOP,PCMV
      INTEGERIERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,LUDONE,IBLK,
     *MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,IFRMAT
      COMMON/PCCOM1/IERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,
     *LUDONE,IBLK,MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,
     *IFRMAT
      SAVE/PCCOM1/
      INTEGERIPRE1,IPRE2,RATIO
      COMMON/PCCOM3/IPRE1,IPRE2,RATIO
      SAVE/PCCOM3/
      INTEGERISRT,IJASGN,ISX0,IFORM
      COMMON/PCVERI/ISRT,IJASGN,ISX0,IFORM
      SAVE/PCVERI/
      LOGICALLOWER,UPPER,FULL,HALF,SYMMAT
      COMMON/PCVERL/LOWER,UPPER,FULL,HALF,SYMMAT
      SAVE/PCVERL/
      INTEGERIBLKN,IC,C,D2I,ID2I,RSRHS,NZRS,IJRS,RS,Y,RSNADR
     *,NSP1,IBLKS,MAXBLK,IRTBM,IBTRM,IBTRMC,IMN,ISCR,IJAB,CP,
     *NBLACK,NBLCKB,IJABP,LINK,IPTR
      INTEGERSISRT,SNVRFY,SIFORM
      INTEGERIRS1,IRS2,I
      INTEGERISAVE(33)
      EQUIVALENCE(IBLKN,ISAVE(8)),(IC,ISAVE(9)),(C,ISAVE(10)),(D2I,
     *ISAVE(11)),(ID2I,ISAVE(12)),(RSRHS,ISAVE(13)),(NZRS,ISAVE(14)),(
     *IJRS,ISAVE(15)),(RS,ISAVE(16)),(Y,ISAVE(17)),(RSNADR,ISAVE(18)),(
     *NSP1,ISAVE(19)),(NBLCKB,ISAVE(20)),(IBLKS,ISAVE(21)),(MAXBLK,
     *ISAVE(22)),(IRTBM,ISAVE(23)),(IBTRM,ISAVE(24)),(IBTRMC,ISAVE(25)
     *),(NBLACK,ISAVE(26)),(IMN,ISAVE(27)),(ISCR,ISAVE(28)),(IJAB,
     *ISAVE(29)),(CP,ISAVE(30)),(IJABP,ISAVE(31)),(LINK,ISAVE(32)),(
     *IPTR,ISAVE(33))
      IRS1=8
      IRS2=33
      IF(RSDONE.EQ.1)THEN
      DO1I=IRS1,IRS2
      ISAVE(I)=ISP(I)
1     CONTINUE
      CALLPCPRMB(NBLCKB,ISP(IBTRM),ISP(C),RHS,RSP(RSRHS))
      CALLPCPRMB(IBLKN-NBLCKB,ISP(IBTRM),ISP(C+NBLCKB),RHS,RSP(Y))
      CALLPCSD2S(IBLKN,ISP(IBLKS),NBLCKB,ISP(C),RSP(D2I),RSP(Y
     *))
      IF(IJASGN.EQ.0)THEN
      CALLPCIABS(N,IJA)
      ENDIF
      IF(HALF)THEN
      CALLPCSC1B(IBLKN,ISP(IBTRM),ISP(IRTBM),ISP(IBTRMC),
     *NBLCKB,ISP(C),ISP(IC),IJA,A,RSP(Y),RSP(RSRHS))
      ELSE
      CALLPCRC1B(IBLKN,ISP(IBTRM),ISP(IRTBM),NBLCKB,ISP(C),
     *ISP(IC),IJA,A,RSP(Y),RSP(RSRHS))
      ENDIF
      ELSE
      IF(RSDONE.EQ.2)THEN
      DO3I=IRS1,IRS2
      ISAVE(I)=ISP(I)
3     CONTINUE
      ENDIF
      CALLPCSRFB(N,IJA,A,RHS,ISP,RSP,LINK,IPTR,IC,C,CP,
     *NBLCKB,NBLACK,IJAB,IBLKN,IBLKS,IBTRM,IRTBM,IBTRMC,
     *ID2I,D2I,NZRS,IJRS,RS,RSRHS,Y,IMN,ISCR,RSNADR,NSP1)
      IF(IERR.NE.0)THEN
      RETURN
      ENDIF
      DO5I=IRS1,IRS2
      ISP(I)=ISAVE(I)
5     CONTINUE
      ENDIF
      IF(NBLACK.NE.0)THEN
      CALLPCPRMB(NBLCKB,ISP(IBTRM),ISP(C),X,RSP(Y))
      SISRT=ISRT
      SNVRFY=NOVERF
      SIFORM=IFORM
      ISRT=0
      NOVERF=2
      IFORM=1
      ISP(1)=NSP1
      ISP(2)=RSNADR
      CALLPCDRVX(NBLACK,ISP(IJRS),RSP(RS),RSP(RSRHS),RSP(Y),ISP,
     *RSP,METHOD,PRECON,PCSTOP,PCMV)
      ISRT=SISRT
      NOVERF=SNVRFY
      IFORM=SIFORM
      IF(IERR.LT.2.OR.IERR.GT.4)THEN
      MNEED=MAX(MNEED,ISCR)+IMN
      ENDIF
      ELSE
      MNEED=IMN+ISCR
      ENDIF
      CALLPCSRRB(N,IBLKN,ISP(IBLKS),ISP(IBTRM),ISP(IRTBM),ISP(
     *IBTRMC),NBLCKB,NBLACK,ISP(C),ISP(IC),IJA,A,RHS,RSP(D2I),
     *RSP(Y),X)
      RETURN
      END
