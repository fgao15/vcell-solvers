      SUBROUTINEPCGMR(N,IJA,A,RHS,X,ISP,RSP,PRECON,PCSTOP,
     *PCMV)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      INTEGERN,IJA(*),ISP(*)
      DOUBLEPRECISIONA(*),RHS(*),X(*),RSP(*)
      EXTERNALPRECON,PCSTOP,PCMV
      INTEGERIERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,LUDONE,IBLK,
     *MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,IFRMAT
      COMMON/PCCOM1/IERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,
     *LUDONE,IBLK,MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,
     *IFRMAT
      SAVE/PCCOM1/
      INTEGERIPRE1,IPRE2,RATIO
      COMMON/PCCOM3/IPRE1,IPRE2,RATIO
      SAVE/PCCOM3/
      INTEGERISTOP,IRESD,INORM,ISAME,ISTATP,IRSDS,IOUT,JOUT,ISTATS,
     *ISTAT1,ISTAT2
      DOUBLEPRECISIONEPS1,EPS2
      COMMON/PCSTIC/ISTOP,IRESD,INORM,ISAME,ISTATP,IRSDS,IOUT,JOUT,
     *ISTATS,ISTAT1,ISTAT2
      COMMON/PCSTRC/EPS1,EPS2
      SAVE/PCSTIC/,/PCSTRC/
      INTEGERSS,VEC,HH,C,S,RS,VNRM,W
      INTEGERNSP,IM,IMP1,NADR,SINORM,NSP1
      NADR=ISP(2)
      NSP=ISP(1)
      IM=KMAX+1
      IMP1=KMAX+2
      SS=NADR+NSP-IMP1*N
      VEC=SS-N
      HH=VEC-IMP1*IM
      C=HH-IM
      S=C-IM
      RS=S-IMP1-1
      VNRM=RS-IMP1
      W=VNRM-IM
      NSP1=W-NADR
      ISP(1)=NSP1
      ISP(3)=NSP1
      IF(NSP1.LT.0)THEN
      RETURN
      ENDIF
      SINORM=INORM
      INORM=-1
      CALLPCGMRX(N,IMP1,IJA,A,RHS,X,RSP(SS),RSP(VEC),RSP(HH),
     *RSP(C),RSP(S),RSP(RS),RSP(VNRM),RSP(W),ISP,RSP,PRECON,
     *PCSTOP,PCMV)
      INORM=SINORM
      RETURN
      END
