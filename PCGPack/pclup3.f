      SUBROUTINEPCLUP3(J,LEVP2,NP1,IJU,IUT,U,LEVL,IPT,ROW,SUM,I1,I2)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      INTEGERJ,LEVL(*),IPT(*),IJU(*),IUT(*),LEVP2,NP1,I1,I2
      DOUBLEPRECISIONROW(*),SUM,U(*)
      INTEGERL1,L2,PREV,LMK,LM,M,IJUM,LV,OLV,K,MLV,LVTEST
      DOUBLEPRECISIONPL,ESUM
      L1=IJU(J)
      L2=IJU(J+1)-1
      PREV=J
      LMK=LEVL(J)
      LM=IPT(J)
      PL=ROW(J)
      ESUM=0.0D0
      LVTEST=LEVP2
      DO1M=L1,L2
      IJUM=IJU(M)
      IF(IJUM.GE.I1)LVTEST=LEVP2+1
      IF(IJUM.GT.I2)LVTEST=LEVP2
      OLV=LEVL(IJUM)
      IF(OLV.GT.LVTEST)THEN
      ROW(IJUM)=0.0D0
      ENDIF
      LV=LMK+IUT(M)
      MLV=MIN(LV,LEVP2)
      LEVL(IJUM)=MLV
      IF(MLV.LT.LVTEST)THEN
      IF(OLV.GE.LVTEST)THEN
      DO3K=1,NP1
      IF(LM.GT.IJUM)THEN
      GOTO4
      ENDIF
      PREV=LM
      LM=IPT(LM)
3     CONTINUE
4     CONTINUE
      IPT(PREV)=IJUM
      IPT(IJUM)=LM
      PREV=IJUM
      SUM=SUM-ROW(IJUM)
      ENDIF
      ELSE
      ESUM=ESUM+U(M)
      ENDIF
      ROW(IJUM)=ROW(IJUM)-PL*U(M)
1     CONTINUE
      SUM=SUM+ESUM*PL
      RETURN
      END
