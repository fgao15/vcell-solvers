      SUBROUTINEPCILY(MODIFY,ICODE,N,IJA,A,W,ISP,RSP)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      LOGICALMODIFY
      INTEGERN,IJA(*),ICODE,ISP(*)
      DOUBLEPRECISIONW(*),A(*),RSP(*)
      INTEGERIERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,LUDONE,IBLK,
     *MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,IFRMAT
      COMMON/PCCOM1/IERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,
     *LUDONE,IBLK,MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,
     *IFRMAT
      SAVE/PCCOM1/
      INTEGERIPRE1,IPRE2,RATIO
      COMMON/PCCOM3/IPRE1,IPRE2,RATIO
      SAVE/PCCOM3/
      INTEGERIJL,IJU,L,D,U,IRSW,IBASE,NANADR,NNFREE,NEXTRA,
     *ANADR,ISTATE(10),LSTRSV
      EQUIVALENCE(IJL,ISTATE(1)),(IJU,ISTATE(2)),(L,ISTATE(3)),(D,
     *ISTATE(4)),(U,ISTATE(5)),(IRSW,ISTATE(6)),(NANADR,ISTATE(7)),(
     *NNFREE,ISTATE(8)),(NEXTRA,ISTATE(9)),(ANADR,ISTATE(10))
      INTEGERI,NADR,INADR
      LSTRSV=10
      IF(ICODE.EQ.0)THEN
      NADR=ISP(2)
      INADR=(NADR-1)*RATIO+1
      IBASE=INADR-1
      IF(LUDONE.EQ.0)THEN
      ISP(2)=ISP(2)+(LSTRSV+RATIO-1)/RATIO
      ISP(1)=ISP(1)-(LSTRSV+RATIO-1)/RATIO
      ELSE
      DO1I=1,LSTRSV
      ISTATE(I)=ISP(IBASE+I)
1     CONTINUE
      ISP(2)=NANADR
      ISP(1)=NNFREE
      ISP(3)=NEXTRA
      ENDIF
      IF(IFRMAT.EQ.0)THEN
      IF(IBLK.EQ.1.OR.PBLK.EQ.1)THEN
      CALLPCILU1(MODIFY,N,IJA,A,ISP,RSP,IJL,IJU,L,U)
      IRSW=U
      ELSEIF(PBLK.EQ.-1)THEN
      CALLPCLUP(MODIFY,N,IJA,A,ISP,RSP,IJL,IJU,L,U,
     *IRSW)
      ELSE
      CALLPCLUB(MODIFY,N,IJA,A,ISP,RSP,IJL,IJU,L,U,
     *IRSW,ANADR)
      ENDIF
      D=L
      ELSE
      IF(MODIFY)THEN
      CALLPCLU1C(MODIFY,N,IJA,A,ISP,RSP,IJL,IJU,L,U)
      D=U
      ELSE
      CALLPCILU1(MODIFY,N,IJA,A,ISP,RSP,IJL,IJU,L,U)
      D=L
      ENDIF
      ENDIF
      NNFREE=ISP(1)
      NANADR=ISP(2)
      NEXTRA=ISP(3)
      DO3I=1,LSTRSV
      ISP(IBASE+I)=ISTATE(I)
3     CONTINUE
      ELSE
      NADR=ISP(4)
      IBASE=(NADR-1)*RATIO
      INADR=IBASE+1
      DO5I=1,LSTRSV
      ISTATE(I)=ISP(IBASE+I)
5     CONTINUE
      IF(IBLK.NE.1.AND.PBLK.NE.1.AND.ICODE.LT.0)THEN
      CALLPCIRSW(N,W,ISP(IRSW))
      ENDIF
      IF(IFRMAT.EQ.0)THEN
      CALLPCICMR(ICODE,N,ISP(IJL),ISP(IJU),RSP(L),RSP(D),
     *RSP(U),W)
      ELSE
      CALLPCICMC(ICODE,N,ISP(IJL),ISP(IJU),RSP(L),RSP(D),
     *RSP(U),W)
      ENDIF
      IF(IBLK.NE.1.AND.PBLK.NE.1.AND.ICODE.GT.0.AND.
     *ICODE.LT.4)THEN
      CALLPCIRSW(N,W,ISP(IRSW))
      ENDIF
      ENDIF
      RETURN
      END
