      SUBROUTINEPCLUBF(MODIFY,N,IJA,IBLKN,NZLUMX,IBLKS,IBTRM,
     *IJLB,IJUB,A,IJL,IJU,IRSW,LD,U,IROW,IPVT,JCOL,ROW)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      LOGICALMODIFY
      INTEGERN,IJA(*),IBLKN,NZLUMX,IBLKS(*),IBTRM(*),IJLB(*),
     *IJUB(*),IJL(*),IJU(*),IRSW(*),IROW(*),IPVT(*),
     *JCOL(*)
      DOUBLEPRECISIONA(*),LD(*),U(*),ROW(*)
      INTEGERIERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,LUDONE,IBLK,
     *MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,IFRMAT
      COMMON/PCCOM1/IERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,
     *LUDONE,IBLK,MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,
     *IFRMAT
      SAVE/PCCOM1/
      DOUBLEPRECISIONACCEL,RESID,ACC2
      COMMON/PCCOM2/ACCEL,RESID,ACC2
      SAVE/PCCOM2/
      INTEGERIPRE1,IPRE2,RATIO
      COMMON/PCCOM3/IPRE1,IPRE2,RATIO
      SAVE/PCCOM3/
      INTEGERI,J,K,NZL,NZU,NLI,NDI,NUI,NI,ONE,RBASE
      ONE=1
      IF(LUDONE.EQ.2)THEN
      IBTRM(1)=1
      DO1I=1,IBLKN
      IBTRM(I+1)=IBTRM(I)+IBLKS(I)
1     CONTINUE
      ENDIF
      IF(MODIFY)THEN
      CALLPC0VI(N,IROW)
      ENDIF
      CALLDCOPY(N,A,ONE,LD,ONE)
      IF(ACCEL.NE.0.0D0)THEN
      DO3I=1,N
      LD(I)=LD(I)+ACCEL
3     CONTINUE
      ENDIF
      NZL=N+1
      NZU=N+1
      IJL(1)=N+2
      IJU(1)=N+2
      DO5K=1,IBLKN
      CALLPCLUB1(MODIFY,N,K,IBLKS,IBTRM,IJLB,IJUB,NI,NLI,
     *NDI,NUI,JCOL,IROW,ROW)
      RBASE=0
      DO7I=IBTRM(K),IBTRM(K+1)-1
      ROW(RBASE+I)=LD(I)
      DO9J=IJA(I),IJA(I+1)-1
      ROW(RBASE+IJA(J))=A(J)
9     CONTINUE
      RBASE=RBASE+N
7     CONTINUE
      CALLPCLUB2(MODIFY,N,K,IBTRM(K),IBTRM(K+1)-1,IBLKS(K),
     *NLI,JCOL,IROW,IJU,U,ROW,ACC2)
      CALLPCLUB3(N,K,IBTRM(K),IBTRM(K+1)-1,IBLKS(K),
     *NDI,NUI,NI,IJU,JCOL,IPVT,IRSW,ROW)
      IF(IERR.NE.0)THEN
      RETURN
      ENDIF
      CALLPCLUB4(N,NZLUMX,IBTRM(K),IBLKS(K),NLI,NI,IPVT,
     *JCOL,ROW,NZL,NZU,IJL,IJU,LD,U)
      IF(IERR.EQ.3)THEN
      NZLUMX=MAX(NZL,NZU)
      RETURN
      ENDIF
      IF(IERR.NE.0)THEN
      NZLUMX=MAX(NZL,NZU)*IBLKN/K
      RETURN
      ENDIF
5     CONTINUE
      RETURN
      END
