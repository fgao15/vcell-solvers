      SUBROUTINEPCSRP(N,IJA,A,RHS,X,ISP,RSP,METHOD,PRECON,
     *PCSTOP,PCMV)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      INTEGERN,IJA(*),ISP(*)
      DOUBLEPRECISIONA(*),RHS(*),X(*),RSP(*)
      EXTERNALMETHOD,PRECON,PCSTOP,PCMV
      INTEGERIERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,LUDONE,IBLK,
     *MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,IFRMAT
      COMMON/PCCOM1/IERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,
     *LUDONE,IBLK,MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,
     *IFRMAT
      SAVE/PCCOM1/
      INTEGERIPRE1,IPRE2,RATIO
      COMMON/PCCOM3/IPRE1,IPRE2,RATIO
      SAVE/PCCOM3/
      INTEGERISRT,IJASGN,ISX0,IFORM
      COMMON/PCVERI/ISRT,IJASGN,ISX0,IFORM
      SAVE/PCVERI/
      LOGICALLOWER,UPPER,FULL,HALF,SYMMAT
      COMMON/PCVERL/LOWER,UPPER,FULL,HALF,SYMMAT
      SAVE/PCVERL/
      INTEGERSISRT,SNVRFY,SIFORM
      INTEGERIBLKN,IC,C,RSRHS,IJRS,RS,Y,RSNADR,NSP1,NBLACK,
     *IMN,ISCR,D2I,NZRS,I,NRED,LINK,IPTR
      INTEGERISAVE(33)
      INTEGERIRS1,IRS2
      EQUIVALENCE(IBLKN,ISAVE(8)),(IC,ISAVE(9)),(C,ISAVE(10)),(D2I,
     *ISAVE(11)),(RSRHS,ISAVE(13)),(NZRS,ISAVE(14)),(IJRS,ISAVE(15)),(
     *RS,ISAVE(16)),(Y,ISAVE(17)),(RSNADR,ISAVE(18)),(NSP1,ISAVE(19)),
     *(NBLACK,ISAVE(26)),(IMN,ISAVE(27)),(ISCR,ISAVE(28)),(LINK,ISAVE(
     *32)),(IPTR,ISAVE(33))
      IRS1=8
      IRS2=33
      IF(IJASGN.EQ.0)THEN
      CALLPCIABS(N,IJA)
      ENDIF
      IF(RSDONE.EQ.1)THEN
      DO1I=IRS1,IRS2
      ISAVE(I)=ISP(I)
1     CONTINUE
      NRED=N-NBLACK
      CALLPCPRMP(NRED,ISP(C+NBLACK),RHS,RSP(Y))
      CALLPCPRMP(NBLACK,ISP(C),RHS,RSP(RSRHS))
      CALLPCVMUL(NRED,RSP(Y),RSP(Y),RSP(D2I))
      IF(HALF)THEN
      CALLPCSC1P(NBLACK,N,ISP(C),ISP(IC),IJA,A,RSP(Y),RSP(
     *RSRHS))
      ELSE
      CALLPCRC1P(NBLACK,N,ISP(C),ISP(IC),IJA,A,RSP(Y),RSP(
     *RSRHS))
      ENDIF
      ELSE
      IF(RSDONE.EQ.2)THEN
      DO3I=IRS1,IRS2
      ISAVE(I)=ISP(I)
3     CONTINUE
      ENDIF
      CALLPCSRFP(N,IJA,A,RHS,ISP,RSP,LINK,IPTR,IC,C,NBLACK
     *,D2I,NZRS,IJRS,RS,RSRHS,Y,IMN,ISCR,RSNADR,NSP1)
      IF(IERR.NE.0)THEN
      RETURN
      ENDIF
      IBLKN=N
      DO5I=IRS1,IRS2
      ISP(I)=ISAVE(I)
5     CONTINUE
      ENDIF
      CALLPCPRMP(NBLACK,ISP(C),X,RSP(Y))
      IF(NBLACK.NE.0)THEN
      SISRT=ISRT
      SNVRFY=NOVERF
      SIFORM=IFORM
      ISRT=0
      NOVERF=2
      IFORM=1
      ISP(1)=NSP1
      ISP(2)=RSNADR
      CALLPCDRVX(NBLACK,ISP(IJRS),RSP(RS),RSP(RSRHS),RSP(Y),ISP,
     *RSP,METHOD,PRECON,PCSTOP,PCMV)
      ISRT=SISRT
      NOVERF=SNVRFY
      IFORM=SIFORM
      IF(IERR.LT.2.OR.IERR.GT.4)THEN
      MNEED=MAX(MNEED,ISCR)+IMN
      ENDIF
      ELSE
      MNEED=IMN+ISCR
      ENDIF
      NRED=N-NBLACK
      IF(HALF)THEN
      CALLPCSRRP(N,NRED,ISP(C),ISP(IC),IJA,A,RHS,RSP(D2I),
     *RSP(Y),RSP(Y+NBLACK))
      ELSE
      CALLPCIPRP(NBLACK,ISP(C),RSP(Y),X)
      CALLPCRDPP(NRED,ISP(C+NBLACK),IJA,A,RHS,RSP(D2I),X)
      ENDIF
      IF(HALF)THEN
      CALLPCPRMP(N,ISP(IC),RSP(Y),X)
      ENDIF
      RETURN
      END
