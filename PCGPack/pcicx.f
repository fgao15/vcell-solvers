      SUBROUTINEPCICX(MODIFY,ICODE,N,IJA,A,W,ISP,RSP)
      IMPLICITDOUBLEPRECISION(A-H,O-Z)
      LOGICALMODIFY
      INTEGERN,IJA(*),ICODE,ISP(*)
      DOUBLEPRECISIONW(*),A(*),RSP(*)
      INTEGERIERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,LUDONE,IBLK,
     *MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,IFRMAT
      COMMON/PCCOM1/IERR,ITMAX,ITEST,KMAX,IFL,IPRE,PBLK,
     *LUDONE,IBLK,MNEED,ITS,RSDONE,NOVERF,RED1,RED2,IERR2,
     *IFRMAT
      SAVE/PCCOM1/
      INTEGERIPRE1,IPRE2,RATIO
      COMMON/PCCOM3/IPRE1,IPRE2,RATIO
      SAVE/PCCOM3/
      INTEGERIJU,UD,IBASE,NANADR,NNFREE,NEXTRA,ISTATE(5),LSTRSV
      EQUIVALENCE(IJU,ISTATE(1)),(UD,ISTATE(2)),(NANADR,ISTATE(3)),(
     *NNFREE,ISTATE(4)),(NEXTRA,ISTATE(5))
      INTEGERI,NADR,INADR
      LSTRSV=5
      IF(ICODE.EQ.0)THEN
      NADR=ISP(2)
      INADR=(NADR-1)*RATIO+1
      IBASE=INADR-1
      IF(LUDONE.NE.0)THEN
      DO1I=1,LSTRSV
      ISTATE(I)=ISP(IBASE+I)
1     CONTINUE
      ISP(2)=NANADR
      ISP(1)=NNFREE
      ISP(3)=NEXTRA
      ENDIF
      ISP(2)=ISP(2)+(LSTRSV+RATIO-1)/RATIO
      ISP(1)=ISP(1)-(LSTRSV+RATIO-1)/RATIO
      IF(IBLK.EQ.1.OR.PBLK.NE.0)THEN
      CALLPCIC1(MODIFY,N,IJA,A,ISP,RSP,IJU,UD)
      ELSE
      CALLPCICB(MODIFY,N,IJA,A,ISP,RSP,IJU,UD)
      ENDIF
      NNFREE=ISP(1)
      NANADR=ISP(2)
      NEXTRA=ISP(3)
      DO3I=1,LSTRSV
      ISP(IBASE+I)=ISTATE(I)
3     CONTINUE
      ELSE
      NADR=ISP(4)
      INADR=(NADR-1)*RATIO+1
      IBASE=INADR-1
      DO5I=1,LSTRSV
      ISTATE(I)=ISP(IBASE+I)
5     CONTINUE
      CALLPCICMS(ICODE,N,ISP(IJU),RSP(UD),W)
      ENDIF
      RETURN
      END
